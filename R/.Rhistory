filelist <- list.files(paste(data_path, "/ECBI_Score_Reports", sep = ""), pattern = "*.pdf")
ids <- c()
for(i in 1:length(filelist))
{
ids <- c(ids, strsplit(filelist[i], "_")[[1]][1]);
}
ids <- unique(ids);
ids <- c(ids, strsplit(filelist[i], "_")[[1]][1]);
{
ids <- c(ids, strsplit(filelist[i], "_")[[1]][1]);
}
ids <- unique(ids);
data <- matrix(, nrow = 0, ncol = length(full_header));
for(i in 1:length(ids))
{
# ECBI files must be named <ID NUMBER>_ECBI_Pilot-T1.pdf
# PSI files must be named <ID NUMBER>_PSI_Pilot-T1.pdf
ECBI_file <- paste(data_path, "/ECBI_Score_Reports/", ids[i], "_ECBI_Pilot-T1.pdf", sep = "")
PSI_file <- paste(data_path, "/PSI_Score_Reports/", ids[i], "_PSI_Pilot-T1.pdf", sep = "")
ECBI_file
PSI_file
print(paste("Processing ECBI and PSI score reports for participant:", ids[i]))
data <- rbind(data, process_pdfs(ECBI_file, PSI_file, event_name));
}
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
salary <- read.csv(file = "data/salary.csv")
```
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
salary <- read.csv(file = "data/salary.csv")
salary_fit = lm(Salary~., data=salary)
salary_fit
late_math = data.frame(Quality=5.4, Experience=17, Publication=6.0)
late_math$Salary = predict(salary_fit, newdata = late_math)
summary(salary_fit)
help("rstudent")
length(stud)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
salary <- read.csv(file = "data/salary.csv")
salary_fit = lm(Salary~., data=salary)
confint(salary_fit,level=0.95)
# Bring in the "wine" data
wine <- read.csv(file = "data/problem_3.csv")
wine_fit = lm(Quality.Rating..y.~., data=wine)
# Scatterplot
plot(wine$Sulfur.Content..x.,wine$Quality.Rating..y.,
main="Sulfur Content x Quality Rating",
xlab="Sulfur Content",
ylab="Quality Rating",
col="navy",
bg="navy",
cex=1.25,
pch=19)
# Studentized residuals
stud = rstudent(wine_fit)
wine_mod = fitted(wine_fit)
plot(wine_mod, stud,
main="Studentized Residuals vs. Predicted",
xlab="Sulfur Content",
ylab="Studentized Residuals",
ylim=(c(-4, 4))
);
# Q-Q Plot
qqnorm(stud,pch = 16);abline(0,1, col="red")
# Shapiro-Wilk Test
shapiro.test(stud)
plot(1:)
length(stud)
stud
plot(1:length(stud), stud)
plot(1:length(stud), stud,
main="Order vs. Studentized Residuals",
xlab="Order",
ylab="Studentized Residuals",
ylim=(c(-4, 4)))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
mileage <- read.csv(file = "data/4_mileage.csv")
stud = rstudent(mileage_fit)
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
stud = rstudent(mileage_fit)
qqnorm(stud,pch = 16);abline(0,1, col="red")
library(tidyverse)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
# Bring in the "tvmarketing.csv" data
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
mileage <- read.csv(file = "data/4_mileage.csv")
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
mileage <- read.csv(file = "data/7_Soft_Drink_Complete.csv")
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
data <- read.csv(file = "data/7_Soft_Drink_Complete.csv")
# Model:
mdl <- lm(Time ~  Cases + Distance, data=data)
summary(mdl)
# Plots for Outliers:
p <- fitted(mdl)    # Fitted (predicted) Values
sr <- rstudent(mdl) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Time', ylab = 'Studentized Residuals', ylim=c(-5, 5))
drink
data
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5))
abline(h = 0, lty = 2 ); abline(h = c(-2.5,2.5), lty = 1, col="orange")
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5))
h <- hatvalues(mileage_fit);
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
cutoff = (2*p)/n
abline(h = cutoff, col = 'black')
h <- hatvalues(mileage_fit);
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
h <- hatvalues(mileage_fit);
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
# Leverage:
h <- hatvalues(mdl);  #Leverage Vales
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
cutoff = (2*p)/n
abline(h = cutoff, col = 'black')
which(h>cutoff) # Prints the observations that are greater than the cutoff.
abline(h = cutoff, col = 'black')
h <- hatvalues(mileage_fit);
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
cutoff = (2*p)/n
abline(h = cutoff, col = 'black')
p = 3; n = 25;
cutoff = (2*p)/n
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
abline(h = cutoff, col = 'black')
# Leverage:
h <- hatvalues(mdl);  #Leverage Vales
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
help(abline)
p = 3; n = 25;
cutoff = (2*p)/n
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
mileage
# Leverage:
h <- hatvalues(mdl);  #Leverage Vales
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
cutoff = (2*p)/n
abline(h = cutoff, col = 'black')
which(h>cutoff) # Prints the observations that are greater than the cutoff.
h <- hatvalues(mileage_fit);
p = 3; n = 25;
cutoff = (2*p)/n
data
mileage
p = 3; n = 25;
cutoff = (2*p)/n
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
p =length(col(mileage))-1; n = nrow(mileage);
cutoff = (2*p)/n
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
p =length(col(mileage))-1; n = nrow(mileage);
cutoff = (2*p)/n
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
cutoff
p = 3; n = 25;
cutoff = (2*p)/n
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
cutoff
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);
p = 3; n = 25;
cutoff = (2*p)/n
abline(h = cutoff, col = 'black')
p = 3; n = 25;
cutoff = (2*p)/n
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
mileage <- read.csv(file = "data/4_mileage.csv")
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
stud = rstudent(mileage_fit)
mileage_fitted = fitted(mileage_fit)
h <- hatvalues(mileage_fit);
p = 3; n = 25;
cutoff = (2*p)/n
plot(h, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
mileage <- read.csv(file = "data/4_mileage.csv")
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 25;
which(h>cutoff)
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
stud = rstudent(mileage_fit)
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
help(hatvalues)
mileage_fit
# Model:
mdl <- lm(Time ~  Cases + Distance, data=data)
summary(mdl)
mdl
summary(mileage_fit)
# Leverage:
h <- hatvalues(mdl);  #Leverage Vales
plot(h, main = "Leverage Plots", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16)
p = 3; n = 25;
cutoff = (2*p)/n
abline(h = cutoff, col = 'black')
which(h>cutoff) # Prints the observations that are greater than the cutoff.
mileage_outlier <- hatvalues(mileage_fit);
p = 2; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
cutoff
mileage_outlier <- hatvalues(mileage_fit);
p = 1; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
p = 3; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
mileage
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 ); abline(h = c(-2.5,2.5), lty = 1, col="orange")
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
mileage <- read.csv(file = "data/4_mileage.csv")
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2) # Prints the observations that are greater than the 2, -2 cutoff.
which(abs(sr)>2) # Prints the observations that are greater than the 2, -2 cutoff.
sr
mileage
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2) # Prints the observations that are greater than the 2, -2 cutoff.
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2.5) # Prints the observations that are greater than the 2, -2 cutoff.
cutoff
p = 3; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
cutoff
# HIPs
c <- cooks.distance(mileage_fit)
# HIPs
c <- cooks.distance(mileage_fit)
plot(c, main = "HIP Plots", ylab = 'Cooks Distance',
xlab = 'Observation Index',pch = 16)
abline(h = 1, col = 'black')
which(c > 1) # Prints the observations that are greater than the cutoff.
Four models are listed below. Fit these models and record the
mod_1 = lm(mileage ~ displacement, data = mileage)
mod_2 = lm(mileage ~ displacement + carburetor, data = mileage)
mod_1
mod_1 = lm(mileage ~ displacement, data = mileage)
mod_2 = lm(mileage ~ displacement + carburetor, data = mileage)
mod_2
mod_1 = lm(mileage ~ displacement, data = mileage)
summary(mod_1)
mod_3 = lm(mileage ~ (displacement)^2 , data = mileage)
summary(mod_3)
mod_4 = lm(mileage ~ carburetor + (displacement)^2, data = mileage)
summary(mod_4)
mod_1
summary(mod_1)
summary(mod_2)
summary(mod_3)
summary(mod_4)
mod_3 = lm(mileage ~ (displacement)^2 , data = mileage)
summary(mod_3)
mod_3 = lm(mileage ~ (displacement)^2 + displacement, data = mileage)
summary(mod_3)
disp2 = displacement^2
disp2 = mileage$displacement^2
mod_3 = lm(mileage ~ disp2 + displacement, data = mileage)
summary(mod_3)
mileage$disp2 = mileage$displacement^2
mileage$disp2 = mileage$displacement^2
mod_3 = lm(mileage ~ disp2 + displacement, data = mileage)
summary(mod_3)
mod_4 = lm(mileage ~ carburetor + displacement + disp2, data = mileage)
summary(mod_4)
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2.5) # Prints the observations that are greater than the 2, -2 cutoff.
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(gridExtra)
library(Rfit)
library(MASS)
#######################################################
# Bring in the "tvmarketing.csv" data
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
mileage <- read.csv(file = "data/4_mileage.csv")
mileage_fit = lm(mileage ~ displacement + carburetor, data = mileage)
summary(mileage_fit)
stud = rstudent(mileage_fit)
mileage_fitted = fitted(mileage_fit)
qqnorm(stud,pch = 16);abline(0,1, col="red")
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2.5) # Prints the observations that are greater than the 2, -2 cutoff.
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 25;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
snameUI <- function(id) {
ns <- NS(id)
tagList(
)
}
nameServer <- function(id) {
moduleServer(
id,
function(input, output, session) {
}
)
}
sr
mileage
stud = rstudent(mileage_fit)
mileage_fitted = fitted(mileage_fit)
qqnorm(stud,pch = 16);abline(0,1, col="red")
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2.5) # Prints the observations that are greater than the 2, -2 cutoff.
setwd("C:/Users/phams/OneDrive/Documents/stat5214g")
data <- read.csv(file = "data/7_Soft_Drink_Complete.csv")
# Model:
mdl <- lm(Time ~  Cases + Distance, data=data)
summary(mdl)
# Plots for Outliers:
p <- fitted(mdl)    # Fitted (predicted) Values
sr <- rstudent(mdl) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Time', ylab = 'Studentized Residuals', ylim=c(-5, 5))
abline(h = 0, lty = 2 ); abline(h = c(-2.5,2.5), lty = 1, col="orange")
nrow(mileage)
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 32;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
p <- fitted(mileage_fit)    # Fitted (predicted) Values
sr <- rstudent(mileage_fit) # Studentized Residuals
plot(p,sr, pch = 16, main = 'Studentized Residuals vs Predicted',
xlab = ' Predicted - Mileage', ylab = 'Studentized Residuals', ylim=c(-5, 5));
abline(h = 0, lty = 2 );
abline(h = c(-2.5,2.5), lty = 1, col="orange")
which(abs(sr)>2.5) # Prints the observations that are greater than the 2, -2 cutoff.
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 32;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
cutoff
mileage_outlier <- hatvalues(mileage_fit);
p = 3; n = 32;
cutoff = (2*p)/n
plot(mileage_outlier, main = "Leverage Points", ylab = 'Leverage Values',
xlab = 'Observation Index',pch = 16);abline(h = cutoff, col = 'black')
which(h>cutoff)
which(mileage_outlier==max(mileage_outlier))
